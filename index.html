<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Climate Demand Intelligence ‚Äî Nike Heat Impact</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=JetBrains+Mono:wght@300;400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0a0c10;
  --surface: #12151c;
  --surface-2: #1a1e28;
  --surface-3: #222836;
  --border: rgba(255,255,255,0.06);
  --text: #e8eaf0;
  --text-muted: #7a8194;
  --text-dim: #4a5068;
  --accent-heat: #ff5722;
  --accent-heat-glow: rgba(255,87,34,0.15);
  --accent-cool: #26c6da;
  --accent-cool-glow: rgba(38,198,218,0.12);
  --accent-green: #66bb6a;
  --accent-amber: #ffb300;
  --accent-red: #ef5350;
  --nike-swoosh: #f5f5f5;
  --gradient-heat: linear-gradient(135deg, #ff5722 0%, #ff9800 50%, #ffb300 100%);
  --gradient-cool: linear-gradient(135deg, #26c6da 0%, #00897b 100%);
  --font-sans: 'DM Sans', -apple-system, sans-serif;
  --font-mono: 'JetBrains Mono', monospace;
  --radius: 12px;
  --radius-sm: 8px;
}

* { margin:0; padding:0; box-sizing:border-box; }

html { font-size: 14px; }

body {
  font-family: var(--font-sans);
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* === HEADER === */
.header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 32px;
  border-bottom: 1px solid var(--border);
  background: var(--surface);
  position: sticky;
  top: 0;
  z-index: 100;
  backdrop-filter: blur(12px);
}

.header-left {
  display: flex;
  align-items: center;
  gap: 20px;
}

.logo-mark {
  display: flex;
  align-items: center;
  gap: 10px;
}

.logo-mark .ey-badge {
  background: #ffe600;
  color: #000;
  font-weight: 700;
  font-size: 13px;
  padding: 4px 10px;
  border-radius: 4px;
  letter-spacing: 1px;
}

.logo-mark .product-name {
  font-size: 15px;
  font-weight: 600;
  letter-spacing: -0.3px;
}

.logo-mark .product-name span {
  color: var(--accent-heat);
}

.header-divider {
  width: 1px;
  height: 24px;
  background: var(--border);
}

.client-badge {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--surface-2);
  padding: 6px 14px;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-muted);
}

.client-badge .swoosh {
  font-size: 16px;
  color: var(--nike-swoosh);
  font-weight: 700;
  font-style: italic;
}

.header-right {
  display: flex;
  align-items: center;
  gap: 16px;
}

.time-horizon-tabs {
  display: flex;
  background: var(--surface-2);
  border-radius: 8px;
  padding: 3px;
  gap: 2px;
}

.time-horizon-tabs button {
  background: none;
  border: none;
  color: var(--text-muted);
  font-family: var(--font-sans);
  font-size: 12px;
  font-weight: 500;
  padding: 6px 14px;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
}

.time-horizon-tabs button.active {
  background: var(--accent-heat);
  color: #fff;
}

.date-display {
  font-family: var(--font-mono);
  font-size: 12px;
  color: var(--text-dim);
}

/* === ALERT BAR === */
.alert-bar {
  background: linear-gradient(90deg, rgba(255,87,34,0.12) 0%, rgba(255,152,0,0.08) 50%, transparent 100%);
  border-bottom: 1px solid rgba(255,87,34,0.15);
  padding: 10px 32px;
  display: flex;
  align-items: center;
  gap: 12px;
  animation: alertPulse 3s ease-in-out infinite;
}

@keyframes alertPulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.85; }
}

.alert-icon {
  width: 8px;
  height: 8px;
  background: var(--accent-heat);
  border-radius: 50%;
  animation: blink 1.5s ease-in-out infinite;
  flex-shrink: 0;
}

@keyframes blink {
  0%, 100% { opacity: 1; box-shadow: 0 0 6px var(--accent-heat); }
  50% { opacity: 0.4; box-shadow: none; }
}

.alert-text {
  font-size: 12px;
  color: var(--accent-heat);
  font-weight: 500;
}

.alert-text strong {
  color: #fff;
  font-weight: 600;
}

/* === MAIN GRID === */
.main {
  padding: 24px 32px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-template-rows: auto auto auto;
  gap: 20px;
  max-width: 1600px;
  margin: 0 auto;
}

/* === CARDS === */
.card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  animation: fadeUp 0.6s ease-out both;
}

@keyframes fadeUp {
  from { opacity:0; transform: translateY(12px); }
  to { opacity:1; transform: translateY(0); }
}

.card:nth-child(1) { animation-delay: 0.05s; }
.card:nth-child(2) { animation-delay: 0.1s; }
.card:nth-child(3) { animation-delay: 0.15s; }
.card:nth-child(4) { animation-delay: 0.2s; }
.card:nth-child(5) { animation-delay: 0.25s; }

.card-header {
  padding: 16px 20px 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid var(--border);
}

.card-title {
  font-size: 13px;
  font-weight: 600;
  letter-spacing: -0.2px;
}

.card-subtitle {
  font-size: 11px;
  color: var(--text-dim);
  font-weight: 400;
  margin-top: 2px;
}

.card-badge {
  font-size: 10px;
  font-family: var(--font-mono);
  padding: 3px 8px;
  border-radius: 4px;
  background: var(--surface-3);
  color: var(--text-muted);
}

.card-body {
  padding: 16px 20px 20px;
}

/* === HEAT MAP CARD (full width) === */
.card-map {
  grid-column: 1 / -1;
}

.map-container {
  display: grid;
  grid-template-columns: 1fr 300px;
  gap: 20px;
  min-height: 320px;
}

.map-visual {
  position: relative;
  background: var(--surface-2);
  border-radius: var(--radius-sm);
  overflow: hidden;
  min-height: 300px;
}

.map-svg-container {
  width: 100%;
  height: 100%;
  position: relative;
}

/* Simplified US map with market bubbles */
.market-bubble {
  position: absolute;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--font-mono);
  font-size: 10px;
  font-weight: 500;
  color: #fff;
}

.market-bubble:hover {
  transform: scale(1.3);
  z-index: 10;
}

.market-bubble.extreme {
  background: radial-gradient(circle, rgba(255,87,34,0.9) 0%, rgba(255,87,34,0.3) 70%);
  box-shadow: 0 0 20px rgba(255,87,34,0.4);
  animation: heatPulse 2s ease-in-out infinite;
}

.market-bubble.high {
  background: radial-gradient(circle, rgba(255,152,0,0.8) 0%, rgba(255,152,0,0.25) 70%);
  box-shadow: 0 0 14px rgba(255,152,0,0.3);
}

.market-bubble.moderate {
  background: radial-gradient(circle, rgba(255,179,0,0.6) 0%, rgba(255,179,0,0.15) 70%);
}

.market-bubble.normal {
  background: radial-gradient(circle, rgba(38,198,218,0.5) 0%, rgba(38,198,218,0.1) 70%);
}

@keyframes heatPulse {
  0%, 100% { box-shadow: 0 0 20px rgba(255,87,34,0.4); }
  50% { box-shadow: 0 0 35px rgba(255,87,34,0.6); }
}

.map-legend {
  position: absolute;
  bottom: 12px;
  left: 12px;
  display: flex;
  gap: 12px;
  background: rgba(10,12,16,0.85);
  padding: 8px 14px;
  border-radius: 8px;
  backdrop-filter: blur(8px);
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 10px;
  color: var(--text-muted);
}

.legend-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
}

.map-sidebar {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.map-sidebar-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.8px;
  margin-bottom: 4px;
}

.market-row {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 12px;
  background: var(--surface-2);
  border-radius: var(--radius-sm);
  border-left: 3px solid transparent;
  cursor: pointer;
  transition: all 0.2s;
}

.market-row:hover {
  background: var(--surface-3);
}

.market-row.extreme { border-left-color: var(--accent-heat); }
.market-row.high { border-left-color: #ff9800; }
.market-row.moderate { border-left-color: var(--accent-amber); }

.market-info {
  flex: 1;
}

.market-name {
  font-size: 12px;
  font-weight: 600;
}

.market-detail {
  font-size: 10px;
  color: var(--text-dim);
  font-family: var(--font-mono);
}

.market-temp {
  font-family: var(--font-mono);
  font-size: 18px;
  font-weight: 700;
}

.market-temp.extreme { color: var(--accent-heat); }
.market-temp.high { color: #ff9800; }
.market-temp.moderate { color: var(--accent-amber); }

.market-anomaly {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--accent-heat);
}

/* === SKU SENSITIVITY === */
.sku-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0 4px;
}

.sku-table th {
  font-size: 10px;
  font-weight: 600;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.8px;
  text-align: left;
  padding: 0 10px 8px;
}

.sku-table th:last-child { text-align: right; }
.sku-table th:nth-child(3) { text-align: center; }

.sku-table td {
  padding: 10px;
  background: var(--surface-2);
  font-size: 12px;
}

.sku-table tr td:first-child { border-radius: 6px 0 0 6px; }
.sku-table tr td:last-child { border-radius: 0 6px 6px 0; text-align: right; }
.sku-table tr td:nth-child(3) { text-align: center; }

.sku-category {
  font-weight: 600;
  font-size: 12px;
}

.sku-examples {
  font-size: 10px;
  color: var(--text-dim);
  margin-top: 2px;
}

.sensitivity-bar-container {
  display: flex;
  align-items: center;
  gap: 8px;
}

.sensitivity-bar {
  height: 6px;
  border-radius: 3px;
  transition: width 1s ease-out;
}

.sensitivity-value {
  font-family: var(--font-mono);
  font-size: 12px;
  font-weight: 500;
  min-width: 45px;
}

.impact-positive { color: var(--accent-green); }
.impact-negative { color: var(--accent-red); }
.impact-neutral { color: var(--text-dim); }

.revenue-impact {
  font-family: var(--font-mono);
  font-weight: 600;
  font-size: 12px;
}

/* === RECOMMENDATIONS === */
.rec-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.rec-item {
  display: flex;
  gap: 12px;
  padding: 12px 14px;
  background: var(--surface-2);
  border-radius: var(--radius-sm);
  border-left: 3px solid;
  transition: background 0.2s;
}

.rec-item:hover { background: var(--surface-3); }

.rec-item.urgent { border-left-color: var(--accent-heat); }
.rec-item.action { border-left-color: var(--accent-amber); }
.rec-item.opportunity { border-left-color: var(--accent-green); }

.rec-icon {
  width: 28px;
  height: 28px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  flex-shrink: 0;
}

.rec-item.urgent .rec-icon { background: var(--accent-heat-glow); }
.rec-item.action .rec-icon { background: rgba(255,179,0,0.12); }
.rec-item.opportunity .rec-icon { background: rgba(102,187,106,0.12); }

.rec-content { flex: 1; }

.rec-title {
  font-size: 12px;
  font-weight: 600;
  margin-bottom: 3px;
}

.rec-desc {
  font-size: 11px;
  color: var(--text-muted);
  line-height: 1.5;
}

.rec-tag {
  font-size: 9px;
  font-family: var(--font-mono);
  padding: 2px 6px;
  border-radius: 3px;
  margin-top: 6px;
  display: inline-block;
}

.rec-item.urgent .rec-tag { background: var(--accent-heat-glow); color: var(--accent-heat); }
.rec-item.action .rec-tag { background: rgba(255,179,0,0.12); color: var(--accent-amber); }
.rec-item.opportunity .rec-tag { background: rgba(102,187,106,0.12); color: var(--accent-green); }

/* === FINANCIAL IMPACT === */
.impact-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}

.impact-metric {
  background: var(--surface-2);
  border-radius: var(--radius-sm);
  padding: 14px 16px;
  position: relative;
  overflow: hidden;
}

.impact-metric::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
}

.impact-metric.up::before { background: var(--gradient-heat); }
.impact-metric.down::before { background: var(--accent-red); }
.impact-metric.neutral::before { background: var(--accent-cool); }
.impact-metric.green::before { background: var(--accent-green); }

.impact-label {
  font-size: 10px;
  color: var(--text-dim);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.6px;
  margin-bottom: 6px;
}

.impact-value {
  font-family: var(--font-mono);
  font-size: 22px;
  font-weight: 700;
  letter-spacing: -0.5px;
}

.impact-value.positive { color: var(--accent-green); }
.impact-value.negative { color: var(--accent-red); }
.impact-value.heat { color: var(--accent-heat); }
.impact-value.amber { color: var(--accent-amber); }

.impact-delta {
  font-size: 10px;
  font-family: var(--font-mono);
  margin-top: 4px;
  color: var(--text-muted);
}

/* === FORECAST TIMELINE === */
.card-forecast {
  grid-column: 1 / -1;
}

/* Market selector */
.market-selector {
  display: flex;
  background: var(--surface-2);
  border-radius: 8px;
  padding: 3px;
  gap: 2px;
}

.mkt-tab {
  background: none;
  border: none;
  color: var(--text-muted);
  font-family: var(--font-sans);
  font-size: 11px;
  font-weight: 500;
  padding: 5px 12px;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.mkt-tab.active {
  background: var(--surface-3);
  color: var(--text);
}

.mkt-tab:hover:not(.active) {
  color: var(--text);
}

/* Chart area */
.forecast-chart-area {
  display: grid;
  grid-template-columns: 48px 1fr;
  grid-template-rows: 1fr auto;
  gap: 0;
  height: 240px;
  margin-bottom: 16px;
}

.chart-y-axis {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding-right: 8px;
  font-family: var(--font-mono);
  font-size: 9px;
  color: var(--text-dim);
  text-align: right;
  padding-bottom: 24px;
}

.chart-body {
  position: relative;
  background: var(--surface-2);
  border-radius: var(--radius-sm);
  overflow: hidden;
  border-left: 1px solid var(--border);
  border-bottom: 1px solid var(--border);
}

.chart-gridline {
  position: absolute;
  left: 0;
  right: 0;
  height: 1px;
  background: rgba(255,255,255,0.04);
}

.chart-gridline.norm-line {
  background: rgba(38,198,218,0.2);
  height: 1px;
}

.chart-gridline.norm-line::after {
  content: 'SEASONAL NORM';
  position: absolute;
  right: 8px;
  top: -8px;
  font-size: 8px;
  font-family: var(--font-mono);
  color: rgba(38,198,218,0.5);
  letter-spacing: 0.5px;
}

/* Impact zones */
.impact-zone {
  position: absolute;
  left: 0;
  right: 0;
  pointer-events: none;
}

.zone-surge {
  background: linear-gradient(180deg, rgba(255,87,34,0.06) 0%, rgba(255,87,34,0.01) 100%);
  border-top: 1px dashed rgba(255,87,34,0.15);
}

.zone-shift {
  background: linear-gradient(180deg, rgba(255,179,0,0.04) 0%, rgba(255,179,0,0.01) 100%);
  border-top: 1px dashed rgba(255,179,0,0.1);
}

.zone-label {
  position: absolute;
  right: 10px;
  top: 4px;
  font-size: 8px;
  font-family: var(--font-mono);
  letter-spacing: 0.8px;
  font-weight: 600;
}

.zone-surge .zone-label { color: rgba(255,87,34,0.35); }
.zone-shift .zone-label { color: rgba(255,179,0,0.3); }

/* Confidence band SVG */
.confidence-svg {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  z-index: 2;
  pointer-events: none;
}

.forecast-line {
  filter: drop-shadow(0 0 4px rgba(255,87,34,0.4));
}

/* Weekly bars */
.weekly-bars {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  top: 0;
  display: flex;
  align-items: flex-end;
  padding: 0 8px;
  gap: 4px;
  z-index: 3;
}

.week-bar-group {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100%;
  justify-content: flex-end;
  position: relative;
  cursor: pointer;
}

.week-bar-group:hover .week-bar {
  filter: brightness(1.3);
}

.week-bar-group:hover .week-bar-label {
  opacity: 1;
}

.week-bar {
  width: 70%;
  border-radius: 3px 3px 0 0;
  transition: all 0.6s cubic-bezier(0.22, 1, 0.36, 1);
  position: relative;
  min-height: 2px;
}

.week-bar.extreme { background: linear-gradient(180deg, #ff5722 0%, #e64a19 100%); }
.week-bar.high { background: linear-gradient(180deg, #ff9800 0%, #ef6c00 100%); }
.week-bar.moderate { background: linear-gradient(180deg, #ffb300 0%, #f9a825 100%); }
.week-bar.mild { background: linear-gradient(180deg, #66bb6a 0%, #43a047 100%); }
.week-bar.normal { background: linear-gradient(180deg, #26c6da 0%, #00acc1 100%); }
.week-bar.cool { background: linear-gradient(180deg, #5c6bc0 0%, #3f51b5 100%); }

.week-bar-label {
  position: absolute;
  top: -22px;
  font-family: var(--font-mono);
  font-size: 9px;
  font-weight: 600;
  white-space: nowrap;
  opacity: 0;
  transition: opacity 0.2s;
  pointer-events: none;
}

.week-bar-label.extreme-label { color: var(--accent-heat); }
.week-bar-label.high-label { color: #ff9800; }
.week-bar-label.moderate-label { color: var(--accent-amber); }
.week-bar-label.mild-label { color: var(--accent-green); }

/* Confidence band on bars */
.week-confidence {
  position: absolute;
  width: 100%;
  border: 1px dashed rgba(255,255,255,0.1);
  border-radius: 2px;
  pointer-events: none;
}

/* Event markers */
.event-marker {
  position: absolute;
  top: 0;
  bottom: 0;
  z-index: 5;
  cursor: pointer;
}

.event-dot {
  width: 10px;
  height: 10px;
  background: var(--accent-heat);
  border: 2px solid var(--bg);
  border-radius: 50%;
  position: absolute;
  top: 8px;
  left: -5px;
  z-index: 2;
}

.event-dot.pulse {
  animation: heatPulse 2s ease-in-out infinite;
}

.event-line {
  position: absolute;
  top: 18px;
  bottom: 0;
  left: 0;
  width: 1px;
  background: rgba(255,87,34,0.25);
}

.chart-x-axis {
  grid-column: 2;
  display: flex;
  padding: 6px 8px 0;
  gap: 4px;
}

.x-label {
  flex: 1;
  text-align: center;
  font-family: var(--font-mono);
  font-size: 9px;
  color: var(--text-dim);
  white-space: nowrap;
}

.x-label.current {
  color: var(--accent-heat);
  font-weight: 700;
}

/* Phase strip */
.phase-strip {
  display: grid;
  grid-template-columns: 2fr 4fr 7fr;
  gap: 6px;
  margin-top: 4px;
}

.phase-block {
  padding: 10px 14px;
  border-radius: var(--radius-sm);
  border-top: 2px solid;
}

.phase-immediate {
  background: rgba(255,87,34,0.06);
  border-top-color: var(--accent-heat);
}

.phase-planning {
  background: rgba(255,179,0,0.05);
  border-top-color: var(--accent-amber);
}

.phase-strategic {
  background: rgba(38,198,218,0.04);
  border-top-color: var(--accent-cool);
}

.phase-label {
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 0.6px;
  margin-bottom: 3px;
}

.phase-immediate .phase-label { color: var(--accent-heat); }
.phase-planning .phase-label { color: var(--accent-amber); }
.phase-strategic .phase-label { color: var(--accent-cool); }

.phase-desc {
  font-size: 10px;
  color: var(--text-muted);
  line-height: 1.4;
}

.phase-weeks {
  font-size: 9px;
  font-family: var(--font-mono);
  color: var(--text-dim);
  margin-top: 4px;
}

/* Confidence indicators */
.conf-indicator {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-dim);
}

.conf-bar {
  height: 4px;
  width: 40px;
  border-radius: 2px;
  background: var(--accent-green);
}

.conf-bar.med {
  background: var(--accent-amber);
}

.conf-bar.low {
  background: var(--accent-heat);
  opacity: 0.7;
}

/* === DATA SOURCES FOOTER === */
.data-sources {
  grid-column: 1 / -1;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 20px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
}

.sources-left {
  display: flex;
  align-items: center;
  gap: 16px;
}

.sources-label {
  font-size: 10px;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.8px;
  font-weight: 600;
}

.source-chip {
  font-size: 11px;
  padding: 4px 10px;
  background: var(--surface-2);
  border-radius: 4px;
  color: var(--text-muted);
  font-weight: 500;
}

.sources-right {
  font-size: 10px;
  font-family: var(--font-mono);
  color: var(--text-dim);
}

/* === US MAP OUTLINE === */
.us-outline {
  position: absolute;
  inset: 0;
  opacity: 0.08;
}

.map-bg-grid {
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
  background-size: 40px 40px;
}

/* Tooltip */
.tooltip {
  position: fixed;
  background: var(--surface-3);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 10px 14px;
  font-size: 11px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.15s;
  z-index: 999;
  max-width: 220px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.4);
}

.tooltip.show { opacity: 1; }

.tooltip-city {
  font-weight: 700;
  font-size: 12px;
  margin-bottom: 4px;
}

.tooltip-detail {
  color: var(--text-muted);
  font-family: var(--font-mono);
  font-size: 10px;
  line-height: 1.6;
}

/* Responsive */
@media (max-width: 1100px) {
  .main {
    grid-template-columns: 1fr;
    padding: 16px;
  }
  .card-map, .card-forecast { grid-column: 1; }
  .map-container { grid-template-columns: 1fr; }
}
</style>
</head>
<body>

<div class="tooltip" id="tooltip">
  <div class="tooltip-city" id="tooltip-city"></div>
  <div class="tooltip-detail" id="tooltip-detail"></div>
</div>

<!-- HEADER -->
<header class="header">
  <div class="header-left">
    <div class="logo-mark">
      <span class="ey-badge">EY</span>
      <span class="product-name">Climate Demand <span>Intelligence</span></span>
    </div>
    <div class="header-divider"></div>
    <div class="client-badge">
      <span class="swoosh">‚úì</span>
      Nike, Inc. ‚Äî North America
    </div>
  </div>
  <div class="header-right">
    <div class="time-horizon-tabs">
      <button class="active">0‚Äì24 months</button>
      <button>2‚Äì5 years</button>
      <button>5+ years</button>
    </div>
    <span class="date-display">11 FEB 2026 ¬∑ 10-DAY OUTLOOK</span>
  </div>
</header>

<!-- ALERT -->
<div class="alert-bar">
  <div class="alert-icon"></div>
  <span class="alert-text">
    <strong>HEAT ADVISORY ACTIVE</strong> ‚Äî Excessive heat warning across 4 of Nike's top 15 DTC markets.
    Forecast anomaly +8‚Äì14¬∞F above seasonal norm through Feb 18. Demand pattern shift confidence: <strong>HIGH</strong>
  </span>
</div>

<!-- MAIN DASHBOARD -->
<main class="main">

  <!-- 90-Day Forecast -->
  <div class="card card-forecast" style="animation-delay:0.02s">
    <div class="card-header">
      <div>
        <div class="card-title">90-Day Heat Anomaly Outlook ‚Äî Composite Across Nike DTC Top 15 Markets</div>
        <div class="card-subtitle">Weekly avg. temperature anomaly vs. 30-year norm ¬∑ demand impact zones ¬∑ confidence bands narrow beyond Week 4</div>
      </div>
      <div style="display:flex;align-items:center;gap:10px;">
        <div class="card-badge">ECMWF SEASONAL + CFS v2</div>
        <div class="card-badge" style="background:rgba(255,87,34,0.12);color:var(--accent-heat);">3 HEAT EVENTS PROJECTED</div>
      </div>
    </div>
    <div class="card-body">
      <!-- Market selector tabs -->
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;">
        <span style="font-size:10px;color:var(--text-dim);font-weight:600;text-transform:uppercase;letter-spacing:0.8px;">Market:</span>
        <div class="market-selector">
          <button class="mkt-tab active" data-market="composite">All Markets (Composite)</button>
          <button class="mkt-tab" data-market="la">Los Angeles</button>
          <button class="mkt-tab" data-market="pdx">Portland</button>
          <button class="mkt-tab" data-market="chi">Chicago</button>
          <button class="mkt-tab" data-market="atl">Atlanta</button>
          <button class="mkt-tab" data-market="dfw">Dallas</button>
        </div>
      </div>

      <!-- Chart area -->
      <div class="forecast-chart-area">
        <!-- Y-axis labels -->
        <div class="chart-y-axis">
          <span>+20¬∞F</span>
          <span>+15¬∞F</span>
          <span>+10¬∞F</span>
          <span>+5¬∞F</span>
          <span>Norm</span>
          <span>-5¬∞F</span>
        </div>

        <!-- Chart body -->
        <div class="chart-body" id="forecastChart">
          <!-- Horizontal grid lines -->
          <div class="chart-gridline" style="bottom:100%"></div>
          <div class="chart-gridline" style="bottom:80%"></div>
          <div class="chart-gridline" style="bottom:60%"></div>
          <div class="chart-gridline" style="bottom:40%"></div>
          <div class="chart-gridline norm-line" style="bottom:20%"></div>
          <div class="chart-gridline" style="bottom:0%"></div>

          <!-- Demand impact zones -->
          <div class="impact-zone zone-surge" style="bottom:70%;height:30%;">
            <span class="zone-label">DEMAND SURGE ZONE</span>
          </div>
          <div class="impact-zone zone-shift" style="bottom:45%;height:25%;">
            <span class="zone-label">CATEGORY SHIFT ZONE</span>
          </div>

          <!-- Confidence band (widens after week 4) -->
          <svg class="confidence-svg" viewBox="0 0 1300 200" preserveAspectRatio="none">
            <defs>
              <linearGradient id="confGrad" x1="0" x2="0" y1="0" y2="1">
                <stop offset="0%" stop-color="rgba(255,87,34,0.12)"/>
                <stop offset="50%" stop-color="rgba(255,87,34,0.04)"/>
                <stop offset="100%" stop-color="rgba(255,87,34,0.12)"/>
              </linearGradient>
            </defs>
            <!-- Confidence band polygon -->
            <polygon fill="url(#confGrad)" points="
              0,58 100,52 200,55 300,72 400,78 500,85 600,90 700,95 800,100 900,105 1000,108 1100,112 1200,115 1300,120
              1300,155 1200,148 1100,142 1000,135 900,128 800,120 700,112 600,105 500,98 400,90 300,82 200,70 100,62 0,68
            "/>
            <!-- Main forecast line -->
            <polyline fill="none" stroke="#ff5722" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
              points="0,63 100,57 200,62 300,77 400,84 500,92 600,98 700,104 800,110 900,117 1000,122 1100,127 1200,132 1300,138"
              class="forecast-line"/>
            <!-- Norm reference line -->
            <line x1="0" y1="160" x2="1300" y2="160" stroke="rgba(38,198,218,0.3)" stroke-width="1" stroke-dasharray="6,4"/>
          </svg>

          <!-- Weekly bars -->
          <div class="weekly-bars" id="weeklyBars">
            <!-- Generated by JS -->
          </div>

          <!-- Event markers -->
          <div class="event-marker" style="left:3.8%" data-event="Current heat wave ‚Äî Extreme anomaly across West Coast & Southeast">
            <div class="event-dot pulse"></div>
            <div class="event-line"></div>
          </div>
          <div class="event-marker" style="left:34.6%" data-event="Projected heat event #2 ‚Äî Central & Southern markets, moderate confidence">
            <div class="event-dot"></div>
            <div class="event-line"></div>
          </div>
          <div class="event-marker" style="left:69.2%" data-event="Projected heat event #3 ‚Äî Early spring heat dome, broad coverage, lower confidence">
            <div class="event-dot"></div>
            <div class="event-line"></div>
          </div>
        </div>

        <!-- X-axis labels -->
        <div class="chart-x-axis" id="chartXAxis">
          <!-- Generated by JS -->
        </div>
      </div>

      <!-- Phase annotations below chart -->
      <div class="phase-strip">
        <div class="phase-block phase-immediate">
          <div class="phase-label">IMMEDIATE RESPONSE</div>
          <div class="phase-desc">Activate surge protocols, emergency transfers, geo-targeted promos</div>
          <div class="phase-weeks">Weeks 1‚Äì2</div>
        </div>
        <div class="phase-block phase-planning">
          <div class="phase-label">ALLOCATION ADJUSTMENT</div>
          <div class="phase-desc">Rebalance spring buy, adjust DC-to-store distribution, shift media mix</div>
          <div class="phase-weeks">Weeks 3‚Äì6</div>
        </div>
        <div class="phase-block phase-strategic">
          <div class="phase-label">SEASONAL STRATEGY</div>
          <div class="phase-desc">Inform summer open-to-buy, pre-position heat-sensitive categories, rethink markdown cadence</div>
          <div class="phase-weeks">Weeks 7‚Äì13</div>
        </div>
      </div>

      <!-- Confidence & source note -->
      <div style="display:flex;justify-content:space-between;margin-top:12px;padding-top:10px;border-top:1px solid var(--border);">
        <div style="display:flex;gap:16px;align-items:center;">
          <div class="conf-indicator">
            <div class="conf-bar" style="width:92%"></div>
            <span>Weeks 1‚Äì2: 92% confidence</span>
          </div>
          <div class="conf-indicator">
            <div class="conf-bar med" style="width:74%"></div>
            <span>Weeks 3‚Äì6: 74% confidence</span>
          </div>
          <div class="conf-indicator">
            <div class="conf-bar low" style="width:55%"></div>
            <span>Weeks 7‚Äì13: 55% confidence</span>
          </div>
        </div>
        <div style="font-size:10px;font-family:var(--font-mono);color:var(--text-dim);">
          Sources: ECMWF Extended Range ¬∑ NOAA CFS v2 ¬∑ Copernicus C3S
        </div>
      </div>
    </div>
  </div>

  <!-- HEAT MAP -->
  <div class="card card-map">
    <div class="card-header">
      <div>
        <div class="card-title">Market Heat Anomaly Map ‚Äî Nike DTC Top Markets</div>
        <div class="card-subtitle">Current temperature deviation from 30-year seasonal norm by metro area</div>
      </div>
      <div class="card-badge">LIVE</div>
    </div>
    <div class="card-body">
      <div class="map-container">
        <div class="map-visual">
          <div class="map-bg-grid"></div>

          <!-- Market bubbles positioned on approximate US map -->
          <div class="market-bubble extreme" style="width:48px;height:48px;left:13%;top:28%" data-city="Portland" data-temp="97¬∞F" data-norm="52¬∞F" data-anom="+45¬∞F" data-impact="Dri-FIT +34%, Running Shoes -8%">PDX</div>

          <div class="market-bubble extreme" style="width:44px;height:44px;left:11%;top:52%" data-city="San Francisco" data-temp="94¬∞F" data-norm="58¬∞F" data-anom="+36¬∞F" data-impact="Sandals +41%, Heavy Fleece -22%">SFO</div>

          <div class="market-bubble extreme" style="width:52px;height:52px;left:14%;top:65%" data-city="Los Angeles" data-temp="108¬∞F" data-norm="68¬∞F" data-anom="+40¬∞F" data-impact="Outdoor Training -15%, Indoor +12%">LAX</div>

          <div class="market-bubble high" style="width:38px;height:38px;left:22%;top:55%" data-city="Phoenix" data-temp="112¬∞F" data-norm="72¬∞F" data-anom="+40¬∞F" data-impact="Already acclimated, lower demand shift">PHX</div>

          <div class="market-bubble moderate" style="width:36px;height:36px;left:32%;top:48%" data-city="Denver" data-temp="78¬∞F" data-norm="45¬∞F" data-anom="+33¬∞F" data-impact="Trail running +18%, Layers -12%">DEN</div>

          <div class="market-bubble high" style="width:42px;height:42px;left:48%;top:52%" data-city="Dallas" data-temp="98¬∞F" data-norm="58¬∞F" data-anom="+40¬∞F" data-impact="Breathable apparel +22%">DFW</div>

          <div class="market-bubble moderate" style="width:40px;height:40px;left:56%;top:42%" data-city="Chicago" data-temp="72¬∞F" data-norm="32¬∞F" data-anom="+40¬∞F" data-impact="Spring pull-forward, winter clearance +30%">ORD</div>

          <div class="market-bubble extreme" style="width:46px;height:46px;left:62%;top:60%" data-city="Atlanta" data-temp="92¬∞F" data-norm="54¬∞F" data-anom="+38¬∞F" data-impact="Running -6%, Studio/Yoga +14%">ATL</div>

          <div class="market-bubble moderate" style="width:38px;height:38px;left:68%;top:56%" data-city="Charlotte" data-temp="84¬∞F" data-norm="50¬∞F" data-anom="+34¬∞F" data-impact="Seasonal shift moderate">CLT</div>

          <div class="market-bubble normal" style="width:34px;height:34px;left:80%;top:32%" data-city="New York" data-temp="48¬∞F" data-norm="38¬∞F" data-anom="+10¬∞F" data-impact="Minimal anomaly, normal patterns">NYC</div>

          <div class="market-bubble normal" style="width:32px;height:32px;left:76%;top:26%" data-city="Boston" data-temp="42¬∞F" data-norm="34¬∞F" data-anom="+8¬∞F" data-impact="Minimal anomaly">BOS</div>

          <div class="market-bubble high" style="width:40px;height:40px;left:72%;top:68%" data-city="Miami" data-temp="94¬∞F" data-norm="76¬∞F" data-anom="+18¬∞F" data-impact="Swimwear surge, outdoor training -10%">MIA</div>

          <div class="map-legend">
            <div class="legend-item"><div class="legend-dot" style="background:var(--accent-heat)"></div>Extreme (>+35¬∞F)</div>
            <div class="legend-item"><div class="legend-dot" style="background:#ff9800"></div>High (+25‚Äì35¬∞F)</div>
            <div class="legend-item"><div class="legend-dot" style="background:var(--accent-amber)"></div>Moderate (+15‚Äì25¬∞F)</div>
            <div class="legend-item"><div class="legend-dot" style="background:var(--accent-cool)"></div>Normal (<+15¬∞F)</div>
          </div>
        </div>

        <div class="map-sidebar">
          <div class="map-sidebar-title">Highest Impact Markets</div>

          <div class="market-row extreme">
            <div class="market-info">
              <div class="market-name">Los Angeles, CA</div>
              <div class="market-detail">Nike DTC rank #1 ¬∑ 23 stores</div>
            </div>
            <div>
              <div class="market-temp extreme">108¬∞F</div>
              <div class="market-anomaly">+40¬∞F above norm</div>
            </div>
          </div>

          <div class="market-row extreme">
            <div class="market-info">
              <div class="market-name">Portland, OR</div>
              <div class="market-detail">Nike HQ market ¬∑ 8 stores</div>
            </div>
            <div>
              <div class="market-temp extreme">97¬∞F</div>
              <div class="market-anomaly">+45¬∞F above norm</div>
            </div>
          </div>

          <div class="market-row extreme">
            <div class="market-info">
              <div class="market-name">San Francisco, CA</div>
              <div class="market-detail">Rank #6 ¬∑ 11 stores</div>
            </div>
            <div>
              <div class="market-temp extreme">94¬∞F</div>
              <div class="market-anomaly">+36¬∞F above norm</div>
            </div>
          </div>

          <div class="market-row extreme">
            <div class="market-info">
              <div class="market-name">Atlanta, GA</div>
              <div class="market-detail">Rank #4 ¬∑ 14 stores</div>
            </div>
            <div>
              <div class="market-temp extreme">92¬∞F</div>
              <div class="market-anomaly">+38¬∞F above norm</div>
            </div>
          </div>

          <div class="market-row high">
            <div class="market-info">
              <div class="market-name">Dallas, TX</div>
              <div class="market-detail">Rank #5 ¬∑ 12 stores</div>
            </div>
            <div>
              <div class="market-temp high">98¬∞F</div>
              <div class="market-anomaly">+40¬∞F above norm</div>
            </div>
          </div>

          <div class="market-row moderate">
            <div class="market-info">
              <div class="market-name">Chicago, IL</div>
              <div class="market-detail">Rank #3 ¬∑ 16 stores</div>
            </div>
            <div>
              <div class="market-temp moderate">72¬∞F</div>
              <div class="market-anomaly">+40¬∞F above norm</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SKU SENSITIVITY MATRIX -->
  <div class="card">
    <div class="card-header">
      <div>
        <div class="card-title">SKU Heat Sensitivity Matrix</div>
        <div class="card-subtitle">Demand elasticity per +10¬∞F anomaly above seasonal norm</div>
      </div>
      <div class="card-badge">ML MODEL v2.3</div>
    </div>
    <div class="card-body">
      <table class="sku-table">
        <thead>
          <tr>
            <th>Category</th>
            <th>Sensitivity</th>
            <th>Direction</th>
            <th>Est. 10-Day Impact</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <div class="sku-category">Dri-FIT Apparel</div>
              <div class="sku-examples">Dri-FIT ADV, Running Tees, Shorts</div>
            </td>
            <td>
              <div class="sensitivity-bar-container">
                <div class="sensitivity-bar" style="width:92%;background:var(--gradient-heat)"></div>
                <span class="sensitivity-value impact-positive">+8.4%</span>
              </div>
            </td>
            <td><span class="impact-positive">‚ñ≤ Surge</span></td>
            <td class="revenue-impact impact-positive">+$4.2M</td>
          </tr>
          <tr>
            <td>
              <div class="sku-category">Sandals & Slides</div>
              <div class="sku-examples">Calm Slides, Offcourt, Victori One</div>
            </td>
            <td>
              <div class="sensitivity-bar-container">
                <div class="sensitivity-bar" style="width:88%;background:var(--gradient-heat)"></div>
                <span class="sensitivity-value impact-positive">+7.6%</span>
              </div>
            </td>
            <td><span class="impact-positive">‚ñ≤ Surge</span></td>
            <td class="revenue-impact impact-positive">+$2.8M</td>
          </tr>
          <tr>
            <td>
              <div class="sku-category">Lightweight Running</div>
              <div class="sku-examples">Pegasus 42, Vomero 18, InfinityRN</div>
            </td>
            <td>
              <div class="sensitivity-bar-container">
                <div class="sensitivity-bar" style="width:40%;background:var(--accent-amber)"></div>
                <span class="sensitivity-value impact-negative">-3.2%</span>
              </div>
            </td>
            <td><span class="impact-negative">‚ñº Drop</span></td>
            <td class="revenue-impact impact-negative">-$1.8M</td>
          </tr>
          <tr>
            <td>
              <div class="sku-category">Indoor / Studio</div>
              <div class="sku-examples">Metcon 9, SuperRep, Yoga mats</div>
            </td>
            <td>
              <div class="sensitivity-bar-container">
                <div class="sensitivity-bar" style="width:55%;background:var(--accent-green)"></div>
                <span class="sensitivity-value impact-positive">+4.1%</span>
              </div>
            </td>
            <td><span class="impact-positive">‚ñ≤ Shift</span></td>
            <td class="revenue-impact impact-positive">+$1.1M</td>
          </tr>
          <tr>
            <td>
              <div class="sku-category">Fleece & Outerwear</div>
              <div class="sku-examples">Tech Fleece, Windrunner, ACG</div>
            </td>
            <td>
              <div class="sensitivity-bar-container">
                <div class="sensitivity-bar" style="width:78%;background:var(--accent-red)"></div>
                <span class="sensitivity-value impact-negative">-6.8%</span>
              </div>
            </td>
            <td><span class="impact-negative">‚ñº Collapse</span></td>
            <td class="revenue-impact impact-negative">-$5.4M</td>
          </tr>
          <tr>
            <td>
              <div class="sku-category">Jordan Retro / Lifestyle</div>
              <div class="sku-examples">AJ1, Dunks, AF1</div>
            </td>
            <td>
              <div class="sensitivity-bar-container">
                <div class="sensitivity-bar" style="width:15%;background:var(--text-dim)"></div>
                <span class="sensitivity-value impact-neutral">+0.3%</span>
              </div>
            </td>
            <td><span class="impact-neutral">‚Äî Stable</span></td>
            <td class="revenue-impact" style="color:var(--text-dim)">~$0.1M</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- FINANCIAL IMPACT SUMMARY -->
  <div class="card">
    <div class="card-header">
      <div>
        <div class="card-title">Projected Financial Impact</div>
        <div class="card-subtitle">10-day rolling estimate across affected Nike DTC markets</div>
      </div>
      <div class="card-badge">95% CI</div>
    </div>
    <div class="card-body">
      <div class="impact-grid">
        <div class="impact-metric up">
          <div class="impact-label">Net Revenue Impact</div>
          <div class="impact-value positive">+$1.0M</div>
          <div class="impact-delta">‚Üë Category shifts net positive</div>
        </div>
        <div class="impact-metric down">
          <div class="impact-label">Inventory Risk ‚Äî Fleece/Outerwear</div>
          <div class="impact-value negative">$5.4M</div>
          <div class="impact-delta">‚Üì Markdown risk if not redirected</div>
        </div>
        <div class="impact-metric green">
          <div class="impact-label">Upside Capture ‚Äî Dri-FIT + Slides</div>
          <div class="impact-value heat">$7.0M</div>
          <div class="impact-delta">Requires inventory rebalancing NOW</div>
        </div>
        <div class="impact-metric neutral">
          <div class="impact-label">Markets w/ Demand Alert</div>
          <div class="impact-value amber">7 of 15</div>
          <div class="impact-delta">4 extreme ¬∑ 2 high ¬∑ 1 moderate</div>
        </div>
      </div>
    </div>
  </div>

  <!-- RECOMMENDATIONS -->
  <div class="card" style="grid-column: 1 / -1">
    <div class="card-header">
      <div>
        <div class="card-title">AI-Generated Action Recommendations</div>
        <div class="card-subtitle">Prioritized by revenue impact and execution window</div>
      </div>
      <div class="card-badge">AUTO-GENERATED</div>
    </div>
    <div class="card-body">
      <div class="rec-list" style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
        <div class="rec-item urgent">
          <div class="rec-icon">üî•</div>
          <div class="rec-content">
            <div class="rec-title">Activate Dri-FIT Surge Protocol</div>
            <div class="rec-desc">Redirect Dri-FIT inventory from DC to LA, Portland, SF, Atlanta stores. Pull forward spring allocation by 2 weeks for affected markets. Estimated capture: +$4.2M.</div>
            <div class="rec-tag">EXECUTE WITHIN 24 HRS</div>
          </div>
        </div>
        <div class="rec-item urgent">
          <div class="rec-icon">ü©¥</div>
          <div class="rec-content">
            <div class="rec-title">Slides & Sandals ‚Äî Emergency Replenishment</div>
            <div class="rec-desc">Calm Slides and Victori One at risk of stockout in 6 affected markets within 72 hours. Trigger emergency transfer from Memphis DC. Weekend sell-through rate projected at 3.2x normal.</div>
            <div class="rec-tag">STOCKOUT RISK ‚Äî ACT NOW</div>
          </div>
        </div>
        <div class="rec-item action">
          <div class="rec-icon">‚ùÑÔ∏è</div>
          <div class="rec-content">
            <div class="rec-title">Hold Fleece Markdowns ‚Äî Don't Panic</div>
            <div class="rec-desc">Anomaly is 7-day event, not structural. Forecast shows return to norm by Feb 19. Delay planned fleece markdowns by 10 days to avoid unnecessary margin erosion on $5.4M of inventory.</div>
            <div class="rec-tag">HOLD ¬∑ REASSESS FEB 18</div>
          </div>
        </div>
        <div class="rec-item opportunity">
          <div class="rec-icon">üì±</div>
          <div class="rec-content">
            <div class="rec-title">Push Nike App Geo-Targeted Promos</div>
            <div class="rec-desc">Deploy geo-fenced push notifications in heat-alert markets promoting Dri-FIT and slides. Historical conversion rate on weather-triggered promos: 2.4x standard campaigns.</div>
            <div class="rec-tag">MARKETING ¬∑ HIGH ROI</div>
          </div>
        </div>
        <div class="rec-item opportunity">
          <div class="rec-icon">üèãÔ∏è</div>
          <div class="rec-content">
            <div class="rec-title">Indoor Training ‚Äî Category Cross-Sell</div>
            <div class="rec-desc">Extreme heat drives gym traffic +18%. Feature Metcon 9 and studio apparel in-store and on nike.com for affected markets. Bundle opportunity with NTC app premium trial.</div>
            <div class="rec-tag">CROSS-SELL OPPORTUNITY</div>
          </div>
        </div>
        <div class="rec-item action">
          <div class="rec-icon">üìä</div>
          <div class="rec-content">
            <div class="rec-title">Adjust Running Shoe Paid Media</div>
            <div class="rec-desc">Reduce paid search spend on outdoor running in extreme-heat markets by 30%. Reallocate to treadmill/indoor running messaging. Avoid promoting long-distance in 100¬∞F+ conditions.</div>
            <div class="rec-tag">MEDIA OPTIMIZATION</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- DATA SOURCES -->
  <div class="data-sources">
    <div class="sources-left">
      <span class="sources-label">Data Sources</span>
      <span class="source-chip">NOAA Weather</span>
      <span class="source-chip">ECMWF Forecasts</span>
      <span class="source-chip">First Street</span>
      <span class="source-chip">Planalytics</span>
      <span class="source-chip">Nike POS (simulated)</span>
      <span class="source-chip">Nike Inventory (simulated)</span>
    </div>
    <div class="sources-right">
      Last updated: 11 Feb 2026 09:42 PST ¬∑ Model confidence: 87%
    </div>
  </div>

</main>

<script>
// Tooltip logic for market bubbles
const tooltip = document.getElementById('tooltip');
const tooltipCity = document.getElementById('tooltip-city');
const tooltipDetail = document.getElementById('tooltip-detail');

document.querySelectorAll('.market-bubble').forEach(bubble => {
  bubble.addEventListener('mouseenter', (e) => {
    const city = bubble.dataset.city;
    const temp = bubble.dataset.temp;
    const norm = bubble.dataset.norm;
    const anom = bubble.dataset.anom;
    const impact = bubble.dataset.impact;

    tooltipCity.textContent = city;
    tooltipDetail.innerHTML = `Current: ${temp} ¬∑ Norm: ${norm}<br>Anomaly: ${anom}<br><br>${impact}`;

    tooltip.classList.add('show');
  });

  bubble.addEventListener('mousemove', (e) => {
    tooltip.style.left = (e.clientX + 14) + 'px';
    tooltip.style.top = (e.clientY - 10) + 'px';
  });

  bubble.addEventListener('mouseleave', () => {
    tooltip.classList.remove('show');
  });
});

// Tab interactivity
document.querySelectorAll('.time-horizon-tabs button').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.time-horizon-tabs button').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  });
});

// Market selector tabs
document.querySelectorAll('.mkt-tab').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.mkt-tab').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  });
});

// Generate 90-day (13-week) forecast bars
const weeklyData = [
  { week: 'W1', dates: 'Feb 11‚Äì17', anomaly: 14.2, label: '+14.2¬∞F', level: 'extreme', event: 'Heat Event #1' },
  { week: 'W2', dates: 'Feb 18‚Äì24', anomaly: 11.8, label: '+11.8¬∞F', level: 'extreme' },
  { week: 'W3', dates: 'Feb 25‚ÄìMar 3', anomaly: 7.4, label: '+7.4¬∞F', level: 'moderate' },
  { week: 'W4', dates: 'Mar 4‚Äì10', anomaly: 4.1, label: '+4.1¬∞F', level: 'mild' },
  { week: 'W5', dates: 'Mar 11‚Äì17', anomaly: 8.6, label: '+8.6¬∞F', level: 'high', event: 'Heat Event #2' },
  { week: 'W6', dates: 'Mar 18‚Äì24', anomaly: 10.2, label: '+10.2¬∞F', level: 'high' },
  { week: 'W7', dates: 'Mar 25‚Äì31', anomaly: 6.8, label: '+6.8¬∞F', level: 'moderate' },
  { week: 'W8', dates: 'Apr 1‚Äì7', anomaly: 3.5, label: '+3.5¬∞F', level: 'mild' },
  { week: 'W9', dates: 'Apr 8‚Äì14', anomaly: 5.2, label: '+5.2¬∞F', level: 'moderate' },
  { week: 'W10', dates: 'Apr 15‚Äì21', anomaly: 9.4, label: '+9.4¬∞F', level: 'high', event: 'Heat Event #3' },
  { week: 'W11', dates: 'Apr 22‚Äì28', anomaly: 7.1, label: '+7.1¬∞F', level: 'moderate' },
  { week: 'W12', dates: 'Apr 29‚ÄìMay 5', anomaly: 4.8, label: '+4.8¬∞F', level: 'mild' },
  { week: 'W13', dates: 'May 6‚Äì12', anomaly: 2.9, label: '+2.9¬∞F', level: 'mild' },
];

const maxAnomaly = 20; // Max scale
const barsContainer = document.getElementById('weeklyBars');
const xAxisContainer = document.getElementById('chartXAxis');

weeklyData.forEach((d, i) => {
  // Bar
  const group = document.createElement('div');
  group.className = 'week-bar-group';
  group.title = `${d.dates}\n${d.label} anomaly`;

  const barHeight = Math.max((d.anomaly / maxAnomaly) * 75, 3); // percentage of chart height (leave room for norm at 20%)
  const bar = document.createElement('div');
  bar.className = `week-bar ${d.level}`;
  bar.style.height = `${barHeight + 20}%`; // offset above the norm line position
  bar.style.animationDelay = `${i * 0.05}s`;
  bar.style.opacity = '0';
  bar.style.transform = 'scaleY(0)';
  bar.style.transformOrigin = 'bottom';

  const label = document.createElement('div');
  label.className = `week-bar-label ${d.level}-label`;
  label.textContent = d.label;
  bar.appendChild(label);

  // Show label always for extreme weeks
  if (d.level === 'extreme') {
    label.style.opacity = '1';
  }

  group.appendChild(bar);
  barsContainer.appendChild(group);

  // Animate in
  setTimeout(() => {
    bar.style.transition = 'all 0.8s cubic-bezier(0.22, 1, 0.36, 1)';
    bar.style.opacity = '1';
    bar.style.transform = 'scaleY(1)';
  }, 100 + i * 60);

  // X-axis label
  const xLabel = document.createElement('div');
  xLabel.className = `x-label ${i === 0 ? 'current' : ''}`;
  xLabel.innerHTML = `${d.week}<br><span style="font-size:8px;opacity:0.6">${d.dates.split('‚Äì')[0]}</span>`;
  xAxisContainer.appendChild(xLabel);
});

// Event marker tooltips
document.querySelectorAll('.event-marker').forEach(marker => {
  marker.addEventListener('mouseenter', (e) => {
    tooltipCity.textContent = 'Projected Heat Event';
    tooltipDetail.textContent = marker.dataset.event;
    tooltip.classList.add('show');
  });
  marker.addEventListener('mousemove', (e) => {
    tooltip.style.left = (e.clientX + 14) + 'px';
    tooltip.style.top = (e.clientY - 10) + 'px';
  });
  marker.addEventListener('mouseleave', () => {
    tooltip.classList.remove('show');
  });
});
</script>

</body>
</html>
